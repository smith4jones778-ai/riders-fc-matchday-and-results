<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Live Matchday</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&display=swap" rel="stylesheet">
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
*{box-sizing:border-box;font-family:'Poppins',sans-serif}
body{margin:0;min-height:100vh;background:radial-gradient(circle at top,#1aff8c,#0a3d2f 45%,#020f0b 85%);color:#fff;display:flex;justify-content:center;align-items:center;padding:20px}
.container{max-width:900px;width:100%;background:rgba(255,255,255,.08);backdrop-filter:blur(22px);border-radius:26px;padding:32px;box-shadow:0 25px 70px rgba(0,0,0,.6)}
h1{text-align:center;font-size:2.6rem;font-weight:800;background:linear-gradient(to right,#1aff8c,#00ffd5);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:24px}
.teams{display:grid;grid-template-columns:1fr auto 1fr;align-items:center;gap:20px}
.team{text-align:center}
.team img{width:90px;height:90px;border-radius:50%;background:#ffffff22;padding:10px}
.vs{font-size:2.2rem;font-weight:800;color:#00ffd5}
.details{margin:22px 0;display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:14px}
.card{background:#00000066;border-radius:16px;padding:16px;text-align:center}
.status{text-align:center;font-size:1.6rem;font-weight:800;color:#1aff8c;margin-top:14px}
.live{margin-top:32px;background:#00000088;border-radius:22px;padding:28px;text-align:center}
.clock{font-size:1.8rem;font-weight:800;color:#00ffd5}
.score{font-size:4rem;font-weight:800;margin:12px 0}
.half{font-size:1.2rem;opacity:.85}
@media(max-width:600px){.score{font-size:3rem}h1{font-size:2.1rem}}
</style>
</head>
<body>
<div class="container">
<h1>IBN VICTORY MOCK NATIONS TOURNAMENT</h1>
  <h1>QUATER FINALS</h1>

<div class="teams">
  <div class="team">
    <img src="riders-logo.jpg" />
    <h2>Riders FC</h2>
  </div>
  <div class="vs">VS</div>
  <div class="team">
    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRmj1Evk5tn4Cs8wg7JGypWQsNCMjRMPghZig&s" />
    <h2>Luke Sport FC</h2>
  </div>
</div>

<div class="details">
  <div class="card">üìÖ Feb 6 2026</div>
  <div class="card">‚è∞ 3:00 PM</div>
  <div class="card">üìç GSS Suleja Field</div>
  <div class="card">üéü Free Entry</div>
  <div class="card">üéü Powered by MathCloud Web Services +2348102341648(WhatsApp)</div>
</div>

<div id="status" class="status"></div>

<div class="live">
  <div id="clock" class="clock">00:00</div>
  <div id="score" class="score">0 : 0</div>
  <div id="half" class="half">PRE MATCH</div>
</div>
</div>

<script>
// ================= FIREBASE =================
const firebaseConfig={
  apiKey:"AIzaSyBK5UM0n8-GLvleW7l6B8Hi-_WuC64QA4U",
  authDomain:"scores-b25a7.firebaseapp.com",
  projectId:"scores-b25a7"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const ref = db.ref('match/live');

let interval = null;

// ================= REALTIME LISTENER =================
ref.on('value', snapshot => {
  const d = snapshot.val();
  if(!d) return;

  document.getElementById('score').innerText = `${d.home} : ${d.away}`;
  document.getElementById('half').innerText = d.half==='PRE'?'PRE MATCH':d.half;
  renderClock(d);
});

// ================= TIMER RENDER =================
function renderClock(d){
  clearInterval(interval);
  if(d.timerRunning && d.startTime){
    interval = setInterval(()=>{
      const sec = (d.elapsed||0) + Math.floor((Date.now() - d.startTime)/1000);
      drawClock(sec);
    },1000);
  }else{
    drawClock(d.elapsed||0);
  }
}

function drawClock(sec){
  const m = String(Math.floor(sec/60)).padStart(2,'0');
  const s = String(sec%60).padStart(2,'0');
  document.getElementById('clock').innerText = `${m}:${s}`;
}

// ================= KICKOFF COUNTDOWN =================
const now = new Date();
const kickoff = new Date(
  now.getFullYear(),
  now.getMonth(),
  now.getDate(),
  16, 0, 0
).getTime();

setInterval(()=>{
  const diff = kickoff - Date.now();
  if(diff <= 0){
    document.getElementById('status').innerText = 'LIVE üî¥';
    return;
  }
  const d = Math.floor(diff/86400000);
  const h = Math.floor(diff/3600000)%24;
  const m = Math.floor(diff/60000)%60;
  const s = Math.floor(diff/1000)%60;
  document.getElementById('status').innerText = `Kickoff in ${d}d ${h}h ${m}m ${s}s`;
},1000);

/* ================= HELPERS ================= */
function detectDeviceType() {
  const ua = navigator.userAgent || '';
  if (/tablet|ipad/i.test(ua)) return 'tablet';
  if (/mobi|android/i.test(ua)) return 'mobile';
  return 'desktop';
}

function parseBrowserInfo() {
  const ua = navigator.userAgent || '';
  let name = 'Unknown', version = '';

  if (/firefox\/([\d.]+)/i.test(ua)) {
    name = 'Firefox'; version = RegExp.$1;
  } else if (/edg\/([\d.]+)/i.test(ua)) {
    name = 'Edge'; version = RegExp.$1;
  } else if (/chrome\/([\d.]+)/i.test(ua)) {
    name = 'Chrome'; version = RegExp.$1;
  } else if (/version\/([\d.]+).*safari/i.test(ua)) {
    name = 'Safari'; version = RegExp.$1;
  }

  return { name, version };
}
/* ========================================== */

/* ================= BUILD VISITOR ================= */
async function buildVisitorPayload() {
  const payload = {
    timestamp: new Date().toISOString(),
    consented: true,
    consentMode: "forced",
    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone || null,
    locale: navigator.language || null,
    userAgent: navigator.userAgent || null,
    platform: navigator.platform || null,
    deviceType: detectDeviceType(),
    screen: {
      width: screen.width,
      height: screen.height
    },
    browser: parseBrowserInfo(),
    referrer: document.referrer || '',

    /* ‚úÖ IMPORTANT CHANGE */
    page: location.href,              // FULL URL (used everywhere)
    pagePath: location.pathname       // extra (non-breaking)
  };

  try {
    const r = await fetch('https://ipapi.co/json/', { cache: 'no-store' });
    if (r.ok) {
      const ip = await r.json();
      payload.ip = ip.ip || '';
      payload.city = ip.city || '';
      payload.region = ip.region || '';
      payload.country = ip.country_name || '';
      payload.latitude = ip.latitude || null;
      payload.longitude = ip.longitude || null;
      payload.org = ip.org || '';
    }
  } catch (e) {
    /* silent fail */
  }

  return payload;
}
/* =============================================== */

/* ================= SAVE VISITOR ================= */
async function saveVisitor(payload) {
  try {
    await db.ref('visitors').push(payload);
  } catch (e) {
    console.error('Visitor save failed', e);
  }
}
/* =============================================== */

/* ================= AUTO RUN ================= */
(async () => {
  const payload = await buildVisitorPayload();
  await saveVisitor(payload);
})();

</script>
</body>
</html>
